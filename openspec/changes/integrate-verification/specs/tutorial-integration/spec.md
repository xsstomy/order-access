# 教程页面订单验证集成规范

## ADDED Requirements

### Requirement: 订单验证覆盖层
系统**必须**在教程页面添加订单验证覆盖层，阻止未验证用户访问教程内容。系统**MUST**添加验证覆盖层阻止未验证访问。

#### Scenario: 首次访问教程页面
**当** 用户首次访问教程页面时
**系统应该** 显示订单验证覆盖层，完全遮盖教程内容
**并且** 禁用页面滚动和交互功能
**直到** 用户成功验证订单号

#### Scenario: 验证成功后访问
**当** 用户订单验证成功后
**系统应该** 隐藏验证覆盖层，显示完整教程内容
**并且** 启用所有页面交互功能
**并且** 保持2小时会话有效期

### Requirement: 验证状态持久化
系统**必须**维持用户验证状态，避免重复验证。系统**MUST**维持验证状态避免重复验证。

#### Scenario: 会话期间访问
**当** 已验证用户在会话有效期内刷新页面时
**系统应该** 直接显示教程内容，无需重新验证
**并且** 延长会话有效期

#### Scenario: 会话过期访问
**当** 用户会话过期后访问教程页面时
**系统应该** 重新显示订单验证覆盖层
**并且** 提示会话已过期需要重新验证

### Requirement: 验证功能集成
系统**必须**将完整的订单验证功能集成到教程页面。系统**MUST**集成验证功能到教程页面。

#### Scenario: 订单验证流程
**当** 用户在验证覆盖层输入订单号时
**系统应该** 调用现有的 `/api/verify` API进行验证
**并且** 显示验证进度指示器
**并且** 统一处理成功和失败状态

#### Scenario: 验证失败处理
**当** 订单验证失败时
**系统应该** 显示统一的错误消息 "订单号无效或已过期"
**并且** 清空输入框，允许重新输入
**并且** 保持覆盖层显示状态

### Requirement: 用户体验优化
系统**必须**提供良好的用户体验，平衡安全性和易用性。系统**MUST**提供良好用户体验平衡安全性和易用性。

#### Scenario: 验证状态指示
**当** 用户已登录验证状态时
**系统应该** 在页面顶部显示验证状态指示器
**并且** 显示剩余会话时间
**并且** 提供退出和刷新会话按钮

#### Scenario: 响应式设计
**当** 用户在移动设备或桌面设备访问时
**系统应该** 确保验证覆盖层和表单完全适配
**并且** 保持现有教程页面的响应式布局

### Requirement: 安全性保障
系统**必须**保持现有安全机制，防止未授权访问。系统**MUST**保持现有安全机制防止未授权访问。

#### Scenario: 防绕过机制
**当** 用户尝试通过开发者工具或其他方式绕过验证时
**系统应该** 通过服务器端验证确保访问权限
**并且** 定期检查会话有效性
**并且** 无效会话自动跳转到验证页面

#### Scenario: 限流保护
**当** 用户频繁提交验证请求时
**系统应该** 应用现有的限流机制（每IP/UA每分钟60次）
**并且** 显示限流提示信息